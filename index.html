<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0D0A1A">
<meta name="mobile-web-app-capable" content="yes">
<title>Sari's Sound Quest</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{font-family:'Fredoka',sans-serif;background:#0D0A1A;color:#fff;overflow-x:hidden;
-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased;min-height:100vh;min-height:100dvh}
button{font-family:'Fredoka',sans-serif;border:none;cursor:pointer;-webkit-appearance:none;color:#fff}
#root{min-height:100vh;min-height:100dvh}
@keyframes confettiFall{0%{opacity:1;transform:translateY(0) rotate(0)}100%{opacity:0;transform:translateY(100vh) rotate(720deg)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}
@keyframes glow{0%,100%{box-shadow:0 0 20px rgba(255,59,139,.4)}50%{box-shadow:0 0 45px rgba(255,59,139,.8)}}
@keyframes slideUp{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}
@keyframes bounceIn{0%{opacity:0;transform:scale(.3)}50%{transform:scale(1.12)}100%{opacity:1;transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}}
@keyframes sparkle{0%,100%{opacity:.2;transform:scale(.7)}50%{opacity:1;transform:scale(1.3)}}
@keyframes rainbowBg{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes popIn{0%{opacity:0;transform:scale(0)}70%{transform:scale(1.15)}100%{opacity:1;transform:scale(1)}}
@keyframes letterSmash{0%{opacity:0;transform:translateX(var(--sx,0)) scale(1.6)}60%{opacity:1;transform:translateX(0) scale(1.1)}80%{transform:translateX(0) scale(.95)}100%{opacity:1;transform:translateX(0) scale(1)}}
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.3.1/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.3.1/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.26.2/babel.min.js"></script>
<script type="text/babel">
const {useState,useEffect,useCallback,useRef} = React;

// â•â•â• DATA â•â•â•
const WORDS=[
{word:"cat",img:"ðŸ±",family:"at"},{word:"bat",img:"ðŸ¦‡",family:"at"},
{word:"hat",img:"ðŸŽ©",family:"at"},{word:"mat",img:"ðŸ§¹",family:"at"},
{word:"sat",img:"ðŸ’º",family:"at"},{word:"rat",img:"ðŸ€",family:"at"},
{word:"pat",img:"ðŸ‘‹",family:"at"},
{word:"dog",img:"ðŸ¶",family:"og"},{word:"log",img:"ðŸªµ",family:"og"},
{word:"hog",img:"ðŸ·",family:"og"},{word:"fog",img:"ðŸŒ«ï¸",family:"og"},
{word:"jog",img:"ðŸƒ",family:"og"},
{word:"pig",img:"ðŸ·",family:"ig"},{word:"big",img:"ðŸ”ï¸",family:"ig"},
{word:"dig",img:"â›ï¸",family:"ig"},{word:"wig",img:"ðŸ’‡",family:"ig"},
{word:"fig",img:"ðŸ‡",family:"ig"},
{word:"sun",img:"â˜€ï¸",family:"un"},{word:"run",img:"ðŸƒ",family:"un"},
{word:"fun",img:"ðŸŽ‰",family:"un"},{word:"bun",img:"ðŸ”",family:"un"},
{word:"cup",img:"â˜•",family:"up"},{word:"pup",img:"ðŸ¶",family:"up"},
{word:"bed",img:"ðŸ›ï¸",family:"ed"},{word:"red",img:"ðŸ”´",family:"ed"},
{word:"pen",img:"ðŸ–Šï¸",family:"en"},{word:"hen",img:"ðŸ”",family:"en"},
{word:"ten",img:"ðŸ”Ÿ",family:"en"},{word:"men",img:"ðŸ‘¨",family:"en"},
{word:"hot",img:"ðŸ”¥",family:"ot"},{word:"pot",img:"ðŸ²",family:"ot"},
{word:"dot",img:"âš«",family:"ot"},{word:"got",img:"ðŸŽ",family:"ot"},
{word:"map",img:"ðŸ—ºï¸",family:"ap"},{word:"cap",img:"ðŸ§¢",family:"ap"},
{word:"tap",img:"ðŸš°",family:"ap"},{word:"nap",img:"ðŸ˜´",family:"ap"},
{word:"fin",img:"ðŸ¦ˆ",family:"in"},{word:"pin",img:"ðŸ“Œ",family:"in"},
{word:"win",img:"ðŸ†",family:"in"},{word:"bin",img:"ðŸ—‘ï¸",family:"in"},
{word:"sit",img:"ðŸª‘",family:"it"},{word:"hit",img:"ðŸ’¥",family:"it"},
{word:"bit",img:"ðŸª",family:"it"},{word:"fit",img:"ðŸ’ª",family:"it"},
{word:"van",img:"ðŸš",family:"an"},{word:"can",img:"ðŸ¥«",family:"an"},
{word:"man",img:"ðŸ§‘",family:"an"},{word:"fan",img:"ðŸŒ€",family:"an"},
{word:"pan",img:"ðŸ³",family:"an"},{word:"ran",img:"ðŸƒ",family:"an"},
{word:"bug",img:"ðŸ›",family:"ug"},{word:"hug",img:"ðŸ¤—",family:"ug"},
{word:"mug",img:"â˜•",family:"ug"},{word:"rug",img:"ðŸŸ«",family:"ug"},
{word:"tug",img:"ðŸš¢",family:"ug"},
{word:"hop",img:"ðŸ‡",family:"op"},{word:"pop",img:"ðŸŽˆ",family:"op"},
{word:"mop",img:"ðŸ§¹",family:"op"},{word:"top",img:"ðŸ”",family:"op"},
];

const LSOUNDS={a:"aah",b:"buh",c:"kuh",d:"duh",e:"eh",f:"fuh",g:"guh",h:"huh",
i:"ih",j:"juh",k:"kuh",l:"luh",m:"muh",n:"nuh",o:"aw",p:"puh",
r:"ruh",s:"sss",t:"tuh",u:"uh",v:"vuh",w:"wuh",x:"ks",y:"yuh",z:"zzz"};

const ALPHA="abcdefghijklmnopqrstuvwxyz".split("");

const CHEERS=[
"Mommy and Daddy love you SO much!","Mommy says you're AMAZING!",
"Daddy is SO proud of you!","Mommy and Daddy are cheering!",
"Bubby Feig is SO proud!","Kira says WOW!","Abby would be amazed!",
"Cousin Ahuvah is cheering!","Baby Talia is clapping for you!",
"Mordechai Shapiro says INCREDIBLE!","Uncle Moishy is dancing!",
"Zisha says AMAZING!","SUPERSTAR SARI!","Bais Yaakov's best!",
"Reading champion!","You're on FIRE!","PERFECT!",
"Like a swimming gold medal!",
"Daniel Tiger says Grrreat job!","You're brave like Daniel Tiger!",
"Ugga Mugga Sari!","Daniel Tiger is SO proud!",
];

const TRIES=[
"Almost! Try the next one!","So close Sari!",
"You're learning! That's great!","Keep going superstar!",
"Next one's yours!","Mommy and Daddy believe in you!",
"Daniel Tiger says keep trying!","Ugga Mugga, you'll get it!",
];

const PRIZES=[
{id:1,stars:10,emoji:"ðŸ•",name:"Pizza Night Coupon!"},
{id:2,stars:25,emoji:"ðŸ¦",name:"Ice Cream Trip!"},
{id:3,stars:50,emoji:"ðŸŒ­",name:"Hot Dog Party!"},
{id:4,stars:75,emoji:"ðŸ¯",name:"Daniel Tiger Movie Night!"},
{id:5,stars:100,emoji:"ðŸ‘‘",name:"Reading Queen Crown!"},
{id:6,stars:150,emoji:"ðŸŠâ€â™€ï¸",name:"Swimming Party with Kira!"},
{id:7,stars:200,emoji:"ðŸ’•",name:"Special Date with Mommy and Daddy!"},
{id:8,stars:300,emoji:"ðŸŽ‚",name:"MEGA CELEBRATION!"},
];

const MODES=[
{id:"sound",emoji:"ðŸ”Š",name:"Sound Match",color:"#FF3B8B",desc:"Hear a sound, find the letter!"},
{id:"rhyme",emoji:"ðŸŽµ",name:"Rhyme Rocket",color:"#B44BFF",desc:"Find the word that rhymes!"},
{id:"blend",emoji:"ðŸš€",name:"Blend Blaster",color:"#00C2FF",desc:"Letters smash together!"},
{id:"build",emoji:"ðŸ”¨",name:"Word Builder",color:"#FF9500",desc:"Build the word letter by letter!"},
];

const ROUND=5;

// â•â•â• HELPERS â•â•â•
const shuf=(a)=>{const b=[...a];for(let i=b.length-1;i>0;i--){const j=0|Math.random()*(i+1);[b[i],b[j]]=[b[j],b[i]]}return b};
const pick=(a)=>a[0|Math.random()*a.length];
const pickN=(a,n)=>shuf(a).slice(0,n);

// â•â•â• SPEECH â•â•â•
let speechReady=false;
const initSpeech=()=>{if(!speechReady&&window.speechSynthesis){const u=new SpeechSynthesisUtterance('');u.volume=0;window.speechSynthesis.speak(u);speechReady=true}};

const say=(text,rate=1,pitch=1.1)=>{
  if(!window.speechSynthesis)return;
  window.speechSynthesis.cancel();
  const u=new SpeechSynthesisUtterance(text);
  u.rate=rate;u.pitch=pitch;u.lang="en-US";
  window.speechSynthesis.speak(u);
};

const saySound=(l)=>say(LSOUNDS[l]||l,0.8,1.0);

const sayBlend=(word,cb)=>{
  const ls=word.split("");let d=0;
  ls.forEach(l=>{setTimeout(()=>say(LSOUNDS[l]||l,0.7,1.0),d);d+=650});
  setTimeout(()=>{say(word,0.85);if(cb)cb()},d+500);
};

// â•â•â• STORAGE â•â•â•
const SKEY="sari_quest_v2";
const DFLT={stars:0,totalCorrect:0,totalPlayed:0,bestStreak:0};
const load=()=>{try{const d=localStorage.getItem(SKEY);return d?JSON.parse(d):{...DFLT}}catch(e){return{...DFLT}}};
const save=(p)=>{try{localStorage.setItem(SKEY,JSON.stringify(p))}catch(e){}};

// â•â•â• QUESTION GENERATORS â•â•â•
const genSound=()=>{
  const w=pick(WORDS);const tl=pick(w.word.split(""));
  const wr=shuf(ALPHA.filter(l=>l!==tl)).slice(0,3);
  return{type:"sound",letter:tl,options:shuf([tl,...wr]),word:w};
};
const genRhyme=()=>{
  const w=pick(WORDS);const rh=WORDS.filter(x=>x.family===w.family&&x.word!==w.word);
  if(!rh.length)return genRhyme();const c=pick(rh);
  const wr=pickN(WORDS.filter(x=>x.family!==w.family),2);
  return{type:"rhyme",target:w,correct:c,options:shuf([c,...wr])};
};
const genBlend=()=>{
  const w=pick(WORDS);const wr=pickN(WORDS.filter(x=>x.word!==w.word&&x.family!==w.family),2);
  return{type:"blend",target:w,options:shuf([w,...wr])};
};
const genBuild=()=>{
  const w=pick(WORDS);const ls=w.word.split("");
  const ex=shuf(ALPHA.filter(l=>!ls.includes(l))).slice(0,3);
  return{type:"build",target:w,tiles:shuf([...ls,...ex])};
};
const GENS={sound:genSound,rhyme:genRhyme,blend:genBlend,build:genBuild};

// â•â•â• CONFETTI â•â•â•
const Confetti=({active})=>{
  if(!active)return null;
  const cols=["#FF3B8B","#FFD700","#00FF88","#B44BFF","#00C2FF","#FF9500"];
  return React.createElement("div",{style:{position:"fixed",inset:0,pointerEvents:"none",zIndex:999}},
    Array.from({length:36}).map((_,i)=>React.createElement("div",{key:i,style:{
      position:"absolute",left:Math.random()*100+"%",top:"-5%",
      width:6+Math.random()*10,height:6+Math.random()*10,
      backgroundColor:pick(cols),borderRadius:Math.random()>.5?"50%":"2px",
      animation:`confettiFall ${.6+Math.random()*1.4}s ease-out forwards`,
      animationDelay:Math.random()*.4+"s",opacity:0
    }}))
  );
};

// â•â•â• STYLING â•â•â•
const bg1="linear-gradient(180deg,#0D0A1A 0%,#1A0A2E 100%)";
const bg2="linear-gradient(135deg,#0D0A1A 0%,#1A0A2E 50%,#0D1A2E 100%)";
const glow1="radial-gradient(ellipse at 30% 20%,rgba(255,59,139,.06) 0%,transparent 50%),radial-gradient(ellipse at 70% 80%,rgba(180,75,255,.06) 0%,transparent 50%)";
const card="linear-gradient(145deg,#2A1F3D,#1E1433)";

const Glow=()=>React.createElement("div",{style:{position:"fixed",inset:0,pointerEvents:"none",zIndex:0,background:glow1}});

// Touch-friendly button wrapper
const Tap=({onClick,onLongPress,style,children,sayText,sayRate})=>{
  const handleClick=()=>{
    if(sayText)say(sayText,sayRate||1);
    if(onClick)onClick();
  };
  return React.createElement("button",{
    onClick:handleClick,
    onTouchStart:e=>{e.currentTarget.style.transform="scale(0.93)"},
    onTouchEnd:e=>{e.currentTarget.style.transform="scale(1)"},
    onMouseDown:e=>{e.currentTarget.style.transform="scale(0.93)"},
    onMouseUp:e=>{e.currentTarget.style.transform="scale(1)"},
    onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},
    style:{transition:"transform .12s",...style}
  },children);
};

// â•â•â• SPLASH SCREEN â•â•â•
const Splash=({onStart})=>{
  const[show,setShow]=useState(false);
  useEffect(()=>{setTimeout(()=>setShow(true),100);},[]);

  const go=()=>{initSpeech();say("Let's go Sari!",1,1.2);setTimeout(onStart,600)};

  // Auto-read the screen
  useEffect(()=>{
    const t=setTimeout(()=>say("Sari's Sound Quest! Tap Let's Go to start!",0.9),800);
    return()=>clearTimeout(t);
  },[]);

  const sparkles=Array.from({length:14}).map((_,i)=>React.createElement("div",{key:i,style:{
    position:"fixed",fontSize:8+Math.random()*16,zIndex:1,
    left:5+Math.random()*90+"%",top:5+Math.random()*90+"%",
    animation:`sparkle ${1.5+Math.random()*2.5}s ease-in-out infinite`,
    animationDelay:Math.random()*3+"s",opacity:.4
  }},["âœ¨","â­","ðŸ’«","ðŸŒŸ"][i%4]));

  return React.createElement("div",{style:{minHeight:"100vh",minHeight:"100dvh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:20,background:bg2}},
    React.createElement(Glow),
    ...sparkles,
    React.createElement("div",{style:{zIndex:2,textAlign:"center",opacity:show?1:0,transform:show?"translateY(0)":"translateY(30px)",transition:"all .9s cubic-bezier(.34,1.56,.64,1)"}},
      React.createElement("div",{style:{fontSize:68,marginBottom:10,animation:"float 3s ease-in-out infinite"}},"ðŸŒŸ"),
      React.createElement("h1",{style:{fontSize:"clamp(36px,10vw,50px)",fontWeight:700,background:"linear-gradient(135deg,#FF3B8B,#FFD700,#B44BFF,#00C2FF)",backgroundSize:"300% 300%",animation:"rainbowBg 4s ease infinite",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",lineHeight:1.1,marginBottom:6}},"SARI'S"),
      React.createElement("h1",{style:{fontSize:"clamp(28px,8vw,42px)",fontWeight:700,letterSpacing:3,marginBottom:18,textShadow:"0 0 35px rgba(255,59,139,.5)"}},"SOUND QUEST"),
      React.createElement("p",{style:{color:"rgba(255,255,255,.5)",fontSize:15,marginBottom:36}},"A reading adventure just for you! ðŸ¯âœ¨"),
      React.createElement(Tap,{onClick:go,style:{background:"linear-gradient(135deg,#FF3B8B,#FF6B8B)",borderRadius:28,padding:"22px 56px",fontSize:"clamp(24px,6vw,30px)",fontWeight:700,animation:"glow 2s ease-in-out infinite",boxShadow:"0 8px 35px rgba(255,59,139,.4)"}},"LET'S GO! ðŸš€")
    )
  );
};

// â•â•â• HOME SCREEN â•â•â•
const Home=({progress,onMode,onPrizes})=>{
  const nx=PRIZES.find(p=>p.stars>progress.stars)||PRIZES[PRIZES.length-1];
  const prev=[...PRIZES].reverse().find(p=>p.stars<=progress.stars);
  const ps=prev?prev.stars:0;
  const rng=nx.stars-ps;
  const pct=rng>0?Math.min(100,((progress.stars-ps)/rng)*100):100;

  // Auto-read home screen
  useEffect(()=>{
    const t=setTimeout(()=>{
      say(`Welcome back Sari! You have ${progress.stars} stars! Pick a game to play!`,0.95);
    },400);
    return()=>clearTimeout(t);
  },[]);

  return React.createElement("div",{style:{minHeight:"100vh",minHeight:"100dvh",display:"flex",flexDirection:"column",alignItems:"center",padding:"20px 16px 40px",background:bg1}},
    React.createElement(Glow),
    React.createElement("div",{style:{zIndex:2,width:"100%",maxWidth:440}},
      // Header
      React.createElement("div",{style:{textAlign:"center",marginBottom:14,animation:"slideUp .5s ease-out"}},
        React.createElement("div",{style:{fontSize:17,color:"rgba(255,255,255,.4)",marginBottom:3}},"Welcome back"),
        React.createElement("div",{style:{fontSize:"clamp(28px,8vw,36px)",fontWeight:700}},"Sari! ðŸŒŸ")
      ),
      // Stars + prizes
      React.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:12,marginBottom:18,animation:"slideUp .6s ease-out"}},
        React.createElement(Tap,{sayText:`You have ${progress.stars} stars!`,style:{background:card,borderRadius:20,padding:"10px 26px",display:"flex",alignItems:"center",gap:8,border:"1px solid rgba(255,215,0,.18)"}},
          React.createElement("span",{style:{fontSize:30}},"â­"),
          React.createElement("span",{style:{fontSize:30,fontWeight:700,color:"#FFD700"}},progress.stars)
        ),
        React.createElement(Tap,{onClick:onPrizes,sayText:"Prizes!",style:{background:card,border:"1px solid rgba(255,59,139,.25)",borderRadius:20,padding:"10px 20px",fontSize:30}},"ðŸŽ")
      ),
      // Progress bar
      React.createElement(Tap,{sayText:`${Math.round(pct)} percent to your next prize, ${nx.name}`,style:{background:"rgba(255,255,255,.04)",borderRadius:18,padding:"14px 18px",marginBottom:26,animation:"slideUp .7s ease-out",border:"1px solid rgba(255,255,255,.06)",width:"100%",textAlign:"left"}},
        React.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8}},
          React.createElement("span",{style:{color:"rgba(255,255,255,.5)",fontSize:12}},"Next prize"),
          React.createElement("span",{style:{fontSize:13,color:"rgba(255,255,255,.6)"}},nx.emoji," ",nx.stars," stars")
        ),
        React.createElement("div",{style:{background:"rgba(255,255,255,.08)",borderRadius:10,height:14,overflow:"hidden"}},
          React.createElement("div",{style:{height:"100%",borderRadius:10,background:"linear-gradient(90deg,#FF3B8B,#FFD700)",width:pct+"%",transition:"width .6s ease",boxShadow:"0 0 12px rgba(255,59,139,.4)"}})
        )
      ),
      // Game mode grid
      React.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,animation:"slideUp .8s ease-out"}},
        ...MODES.map((m,i)=>React.createElement(Tap,{key:m.id,
          onClick:()=>onMode(m.id),
          sayText:m.name+"! "+m.desc,
          style:{background:`linear-gradient(145deg,${m.color}18,${m.color}08)`,border:`2.5px solid ${m.color}44`,borderRadius:24,padding:"clamp(16px,4vw,24px) 10px",display:"flex",flexDirection:"column",alignItems:"center",gap:6,animation:`bounceIn .5s ease-out ${.08*i}s both`}
        },
          React.createElement("div",{style:{fontSize:"clamp(36px,10vw,50px)"}},m.emoji),
          React.createElement("div",{style:{fontSize:"clamp(15px,4vw,18px)",fontWeight:700,textAlign:"center",lineHeight:1.2}},m.name),
          React.createElement("div",{style:{fontSize:10,color:"rgba(255,255,255,.4)",textAlign:"center"}},m.desc)
        ))
      ),
      progress.totalPlayed>0&&React.createElement("div",{style:{textAlign:"center",marginTop:20,color:"rgba(255,255,255,.25)",fontSize:12,animation:"slideUp 1s ease-out"}},
        progress.totalCorrect," words correct so far! ðŸ“š",
        progress.bestStreak>0&&(" Â· Best streak: "+progress.bestStreak+" ðŸ”¥")
      )
    )
  );
};

// â•â•â• SOUND MATCH â•â•â•
const SoundGame=({q,onAns})=>{
  const[sel,setSel]=useState(null);
  const[res,setRes]=useState(null);

  useEffect(()=>{
    setSel(null);setRes(null);
    const t=setTimeout(()=>{say("Which letter makes this sound?",0.95);setTimeout(()=>saySound(q.letter),1800)},300);
    return()=>clearTimeout(t);
  },[q]);

  const pick_l=(l)=>{
    if(sel)return;setSel(l);
    const ok=l===q.letter;setRes(ok);
    const msg=ok?pick(CHEERS):("The letter was "+q.letter.toUpperCase()+". "+pick(TRIES));
    if(ok)say("Yes! "+pick(CHEERS),1.1);
    else setTimeout(()=>say(msg,0.95),200);
    setTimeout(()=>onAns(ok),ok?1400:2200);
  };

  return React.createElement("div",{style:{textAlign:"center",animation:"slideUp .4s ease-out"}},
    React.createElement("div",{style:{fontSize:15,color:"rgba(255,255,255,.45)",marginBottom:10}},"Listen and find the letter!"),
    React.createElement(Tap,{onClick:()=>saySound(q.letter),style:{background:"linear-gradient(135deg,#FF3B8B,#FF6B8B)",borderRadius:50,width:"clamp(90px,22vw,120px)",height:"clamp(90px,22vw,120px)",fontSize:"clamp(40px,10vw,56px)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",animation:"pulse 2s ease-in-out infinite",boxShadow:"0 8px 35px rgba(255,59,139,.35)"}},"ðŸ”Š"),
    React.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"clamp(10px,3vw,16px)",maxWidth:320,margin:"0 auto"}},
      ...q.options.map((l,i)=>{
        const isC=l===q.letter,isS=l===sel;
        let bg=card,brd="2.5px solid rgba(255,255,255,.12)",anim=`popIn .3s ease-out ${i*.08}s both`;
        if(res!==null&&isC){bg="linear-gradient(145deg,#00FF88,#00CC66)";brd="2.5px solid #00FF88"}
        if(isS&&res===false){bg="linear-gradient(145deg,#FF6B6B,#FF4444)";brd="2.5px solid #FF6B6B";anim="shake .4s ease"}
        return React.createElement("button",{key:l+i,onClick:()=>pick_l(l),style:{
          width:"100%",height:"clamp(70px,18vw,88px)",borderRadius:18,display:"flex",alignItems:"center",justifyContent:"center",
          fontSize:"clamp(30px,8vw,40px)",fontWeight:700,textTransform:"uppercase",
          background:bg,border:brd,cursor:sel?"default":"pointer",animation:anim
        }},l.toUpperCase());
      })
    ),
    res!==null&&React.createElement("div",{style:{marginTop:18,fontSize:17,fontWeight:600,animation:"bounceIn .3s ease-out",color:res?"#00FF88":"#FF6B6B",padding:"0 12px"}},
      res?pick(CHEERS):`It was "${q.letter.toUpperCase()}" â€” ${pick(TRIES)}`
    )
  );
};

// â•â•â• RHYME GAME â•â•â•
const RhymeGame=({q,onAns})=>{
  const[sel,setSel]=useState(null);
  const[res,setRes]=useState(null);

  useEffect(()=>{
    setSel(null);setRes(null);
    const t=setTimeout(()=>{say("What rhymes with "+q.target.word+"?",0.9);setTimeout(()=>say(q.target.word,0.85),2000)},300);
    return()=>clearTimeout(t);
  },[q]);

  const tap=(w)=>{
    if(sel)return;setSel(w.word);
    const ok=w.word===q.correct.word;setRes(ok);
    if(ok)say("Yes! "+q.target.word+" and "+w.word+" rhyme! "+pick(CHEERS),1);
    else setTimeout(()=>say(q.target.word+" rhymes with "+q.correct.word+". "+pick(TRIES),0.9),300);
    setTimeout(()=>onAns(ok),ok?1500:2400);
  };

  return React.createElement("div",{style:{textAlign:"center",animation:"slideUp .4s ease-out"}},
    React.createElement("div",{style:{fontSize:15,color:"rgba(255,255,255,.45)",marginBottom:12}},"What rhymes with..."),
    React.createElement(Tap,{onClick:()=>say(q.target.word,0.85),sayText:q.target.word,style:{background:"linear-gradient(145deg,#B44BFF22,#B44BFF0A)",border:"2.5px solid #B44BFF44",borderRadius:22,padding:"clamp(12px,3vw,18px) clamp(20px,5vw,32px)",display:"inline-flex",alignItems:"center",gap:10,marginBottom:24}},
      React.createElement("span",{style:{fontSize:"clamp(36px,9vw,48px)"}},q.target.img),
      React.createElement("span",{style:{fontSize:"clamp(24px,7vw,34px)",fontWeight:700,textTransform:"uppercase"}},q.target.word),
      React.createElement("span",{style:{fontSize:22}},"ðŸ”Š")
    ),
    React.createElement("div",{style:{display:"flex",flexDirection:"column",gap:12,maxWidth:340,margin:"0 auto"}},
      ...q.options.map((w,i)=>{
        const isC=w.word===q.correct.word,isS=w.word===sel;
        let bg=card,brd="2.5px solid rgba(255,255,255,.1)",anim=`popIn .3s ease-out ${i*.1}s both`;
        if(res!==null&&isC){bg="linear-gradient(145deg,#00FF8822,#00CC6611)";brd="2.5px solid #00FF88"}
        if(isS&&res===false){bg="linear-gradient(145deg,#FF6B6B22,#FF444411)";brd="2.5px solid #FF6B6B";anim="shake .4s ease"}
        return React.createElement("button",{key:w.word,onClick:()=>tap(w),style:{
          background:bg,border:brd,borderRadius:18,padding:"clamp(12px,3vw,16px) 18px",
          display:"flex",alignItems:"center",gap:12,cursor:sel?"default":"pointer",animation:anim
        }},
          React.createElement("span",{style:{fontSize:"clamp(28px,8vw,38px)"}},w.img),
          React.createElement("span",{style:{fontSize:"clamp(20px,5vw,26px)",fontWeight:600,textTransform:"uppercase"}},w.word)
        );
      })
    ),
    res!==null&&React.createElement("div",{style:{marginTop:18,fontSize:17,fontWeight:600,animation:"bounceIn .3s ease-out",color:res?"#00FF88":"#FF6B6B",padding:"0 12px"}},
      res?pick(CHEERS):pick(TRIES)
    )
  );
};

// â•â•â• BLEND GAME â•â•â•
const BlendGame=({q,onAns})=>{
  const[phase,setPhase]=useState("blend");
  const[sel,setSel]=useState(null);
  const[res,setRes]=useState(null);

  useEffect(()=>{
    setPhase("blend");setSel(null);setRes(null);
    const t=setTimeout(()=>{
      say("Watch the letters blend together!",0.95);
      setTimeout(()=>{
        sayBlend(q.target.word,()=>setPhase("pick"));
      },2000);
    },300);
    return()=>clearTimeout(t);
  },[q]);

  const tap=(w)=>{
    if(sel)return;setSel(w.word);
    const ok=w.word===q.target.word;setRes(ok);
    if(ok)say("Yes! "+w.word+"! "+pick(CHEERS),1.1);
    else setTimeout(()=>say("It was "+q.target.word+". "+pick(TRIES),0.9),300);
    setTimeout(()=>onAns(ok),ok?1400:2200);
  };

  const ls=q.target.word.split("");

  return React.createElement("div",{style:{textAlign:"center",animation:"slideUp .4s ease-out"}},
    React.createElement("div",{style:{fontSize:15,color:"rgba(255,255,255,.45)",marginBottom:18}},"Watch the letters blend!"),
    React.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:phase==="blend"?24:6,marginBottom:16,transition:"gap .7s cubic-bezier(.34,1.56,.64,1)",minHeight:90}},
      ...ls.map((l,i)=>React.createElement("div",{key:i,style:{
        fontSize:"clamp(40px,12vw,56px)",fontWeight:700,color:"#00C2FF",textTransform:"uppercase",
        animation:`letterSmash .5s ease-out ${i*.45}s both`,
        textShadow:"0 0 25px rgba(0,194,255,.5)",
        "--sx":i===0?"-70px":i===ls.length-1?"70px":"0px"
      }},l)),
      phase==="pick"&&React.createElement("div",{style:{fontSize:22,color:"#FFD700",marginLeft:8,animation:"bounceIn .3s ease-out"}},"= ?")
    ),
    React.createElement(Tap,{onClick:()=>sayBlend(q.target.word),sayText:null,style:{background:"none",fontSize:15,color:"rgba(255,255,255,.4)",marginBottom:22,padding:"6px 14px"}},"ðŸ”Š Hear again"),
    phase==="pick"&&React.createElement("div",{style:{display:"flex",flexDirection:"column",gap:12,maxWidth:340,margin:"0 auto"}},
      ...q.options.map((w,i)=>{
        const isC=w.word===q.target.word,isS=w.word===sel;
        let bg=card,brd="2.5px solid rgba(255,255,255,.1)",anim=`popIn .3s ease-out ${i*.1}s both`;
        if(res!==null&&isC){bg="linear-gradient(145deg,#00FF8822,#00CC6611)";brd="2.5px solid #00FF88"}
        if(isS&&res===false){bg="linear-gradient(145deg,#FF6B6B22,#FF444411)";brd="2.5px solid #FF6B6B";anim="shake .4s ease"}
        return React.createElement("button",{key:w.word,onClick:()=>tap(w),style:{
          background:bg,border:brd,borderRadius:18,padding:"clamp(12px,3vw,16px) 18px",
          display:"flex",alignItems:"center",gap:12,cursor:sel?"default":"pointer",animation:anim
        }},
          React.createElement("span",{style:{fontSize:"clamp(28px,8vw,38px)"}},w.img),
          React.createElement("span",{style:{fontSize:"clamp(20px,5vw,26px)",fontWeight:600,textTransform:"uppercase"}},w.word)
        );
      })
    ),
    res!==null&&React.createElement("div",{style:{marginTop:18,fontSize:17,fontWeight:600,animation:"bounceIn .3s ease-out",color:res?"#00FF88":"#FF6B6B",padding:"0 12px"}},
      res?pick(CHEERS):pick(TRIES)
    )
  );
};

// â•â•â• WORD BUILDER â•â•â•
const BuildGame=({q,onAns})=>{
  const[built,setBuilt]=useState([]);
  const[used,setUsed]=useState(new Set());
  const[res,setRes]=useState(null);

  useEffect(()=>{
    setBuilt([]);setUsed(new Set());setRes(null);
    const t=setTimeout(()=>{say("Build the word! Listen!",0.95);setTimeout(()=>say(q.target.word,0.85),1800)},300);
    return()=>clearTimeout(t);
  },[q]);

  const tap=(l,idx)=>{
    if(res!==null||used.has(idx))return;
    const nb=[...built,l];const nu=new Set(used);nu.add(idx);
    setBuilt(nb);setUsed(nu);saySound(l);
    if(nb.length===q.target.word.length){
      const ok=nb.join("")===q.target.word;setRes(ok);
      if(ok)say("Yes! "+q.target.word+"! "+pick(CHEERS),1.1);
      else setTimeout(()=>say("The word is "+q.target.word+". "+pick(TRIES),0.9),400);
      setTimeout(()=>onAns(ok),ok?1400:2400);
    }
  };

  const undo=()=>{
    if(!built.length||res!==null)return;
    const ll=built[built.length-1];
    const su=[...used].sort((a,b)=>b-a);
    const rm=su.find(idx=>q.tiles[idx]===ll);
    const nu=new Set(used);if(rm!==undefined)nu.delete(rm);
    setBuilt(built.slice(0,-1));setUsed(nu);
  };

  return React.createElement("div",{style:{textAlign:"center",animation:"slideUp .4s ease-out"}},
    React.createElement("div",{style:{fontSize:15,color:"rgba(255,255,255,.45)",marginBottom:10}},"Build the word!"),
    React.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:10,marginBottom:16}},
      React.createElement(Tap,{onClick:()=>say(q.target.word,0.85),style:{background:"linear-gradient(135deg,#FF9500,#FFB347)",borderRadius:50,width:"clamp(72px,18vw,90px)",height:"clamp(72px,18vw,90px)",fontSize:"clamp(34px,9vw,44px)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 6px 24px rgba(255,149,0,.3)"}},"ðŸ”Š"),
      React.createElement("span",{style:{fontSize:"clamp(40px,10vw,52px)"}},q.target.img)
    ),
    // Slots
    React.createElement("div",{style:{display:"flex",justifyContent:"center",gap:"clamp(6px,2vw,10px)",marginBottom:24}},
      ...Array.from({length:q.target.word.length}).map((_,i)=>React.createElement("div",{key:i,style:{
        width:"clamp(52px,14vw,66px)",height:"clamp(58px,16vw,74px)",borderRadius:16,
        background:built[i]?"linear-gradient(145deg,#FF950028,#FF950010)":"rgba(255,255,255,.04)",
        border:built[i]?"2.5px solid #FF9500":"2.5px dashed rgba(255,255,255,.18)",
        display:"flex",alignItems:"center",justifyContent:"center",
        fontSize:"clamp(28px,7vw,36px)",fontWeight:700,textTransform:"uppercase",
        animation:built[i]?"popIn .2s ease-out":undefined
      }},built[i]||""))
    ),
    // Tiles
    React.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"clamp(8px,2vw,12px)",maxWidth:380,margin:"0 auto",marginBottom:18}},
      ...q.tiles.map((l,i)=>{
        const u=used.has(i);
        return React.createElement("button",{key:i,onClick:()=>tap(l,i),style:{
          width:"clamp(52px,14vw,66px)",height:"clamp(52px,14vw,66px)",borderRadius:16,
          display:"flex",alignItems:"center",justifyContent:"center",
          fontSize:"clamp(24px,6vw,32px)",fontWeight:700,textTransform:"uppercase",
          background:u?"rgba(255,255,255,.02)":card,
          border:u?"2.5px solid rgba(255,255,255,.04)":"2.5px solid rgba(255,255,255,.14)",
          color:u?"rgba(255,255,255,.12)":"white",
          cursor:u||res!==null?"default":"pointer",
          animation:`popIn .2s ease-out ${i*.05}s both`,userSelect:"none"
        }},l.toUpperCase());
      })
    ),
    built.length>0&&res===null&&React.createElement(Tap,{onClick:undo,sayText:"undo",style:{background:"rgba(255,255,255,.07)",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:"8px 22px",color:"rgba(255,255,255,.5)",fontSize:14}},"â¬…ï¸ Undo"),
    res!==null&&React.createElement("div",{style:{marginTop:18,fontSize:17,fontWeight:600,animation:"bounceIn .3s ease-out",color:res?"#00FF88":"#FF6B6B",padding:"0 12px"}},
      res?pick(CHEERS):`The word was "${q.target.word.toUpperCase()}" â€” ${pick(TRIES)}`
    )
  );
};

// â•â•â• GAME SESSION â•â•â•
const Game=({mode,onFinish,onBack})=>{
  const[qs]=useState(()=>Array.from({length:ROUND},()=>GENS[mode]()));
  const[qi,setQi]=useState(0);
  const[results,setResults]=useState([]);
  const[conf,setConf]=useState(false);
  const mi=MODES.find(m=>m.id===mode);

  const handleAns=(ok)=>{
    const nr=[...results,ok];setResults(nr);
    if(ok){setConf(true);setTimeout(()=>setConf(false),1600)}
    // Advance handled by child component timeout
    setTimeout(()=>{
      if(qi+1>=ROUND)onFinish(nr);
      else setQi(qi+1);
    },ok?1500:2500);
  };

  return React.createElement("div",{style:{minHeight:"100vh",minHeight:"100dvh",display:"flex",flexDirection:"column",alignItems:"center",padding:"20px 16px 40px",background:bg1}},
    React.createElement(Glow),
    React.createElement(Confetti,{active:conf}),
    React.createElement("div",{style:{zIndex:2,width:"100%",maxWidth:440}},
      // Top bar
      React.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:22}},
        React.createElement(Tap,{onClick:()=>{say("Going back!");onBack()},style:{background:"rgba(255,255,255,.07)",borderRadius:12,padding:"8px 16px",fontSize:15,color:"rgba(255,255,255,.5)"}},"â† Back"),
        React.createElement(Tap,{sayText:mi.name,style:{display:"flex",alignItems:"center",gap:6,background:"none",padding:4}},
          React.createElement("span",{style:{fontSize:20}},mi.emoji),
          React.createElement("span",{style:{fontSize:13,color:"rgba(255,255,255,.4)",fontWeight:600}},mi.name)
        ),
        React.createElement("div",{style:{fontSize:13,color:"rgba(255,255,255,.35)",fontWeight:500}},qi+1," / ",ROUND)
      ),
      // Dots
      React.createElement("div",{style:{display:"flex",justifyContent:"center",gap:9,marginBottom:28}},
        ...Array.from({length:ROUND}).map((_,i)=>React.createElement("div",{key:i,style:{
          width:"clamp(12px,3vw,16px)",height:"clamp(12px,3vw,16px)",borderRadius:8,
          background:i<results.length?(results[i]?"#00FF88":"#FF6B6B"):i===qi?(mi.color):"rgba(255,255,255,.12)",
          transition:"all .3s ease",
          boxShadow:i===qi?`0 0 12px ${mi.color}55`:"none"
        }}))
      ),
      // Game
      mode==="sound"&&React.createElement(SoundGame,{q:qs[qi],onAns:handleAns}),
      mode==="rhyme"&&React.createElement(RhymeGame,{q:qs[qi],onAns:handleAns}),
      mode==="blend"&&React.createElement(BlendGame,{q:qs[qi],onAns:handleAns}),
      mode==="build"&&React.createElement(BuildGame,{q:qs[qi],onAns:handleAns})
    )
  );
};

// â•â•â• RESULTS â•â•â•
const Results=({results,earned,onHome,onAgain,prize})=>{
  const ok=results.filter(Boolean).length;
  const pct=Math.round(ok/results.length*100);
  const[conf,setConf]=useState(false);

  useEffect(()=>{
    if(pct>=60){setConf(true);setTimeout(()=>setConf(false),3500)}
    const t=setTimeout(()=>{
      if(pct===100)say("Perfect score! Amazing Sari! Mommy and Daddy are so proud! You earned "+earned+" stars!",1);
      else if(pct>=60)say("Great job Sari! You earned "+earned+" stars! "+pick(CHEERS),1);
      else say("Good try Sari! You earned "+earned+" stars! Keep practicing!",1);
    },400);
    return()=>clearTimeout(t);
  },[]);

  const em=pct===100?"ðŸ‘‘":pct>=80?"ðŸ†":pct>=60?"â­":"ðŸ’ª";
  const msg=pct===100?"PERFECT!":pct>=80?"AMAZING!":pct>=60?"GREAT JOB!":"KEEP GOING!";

  return React.createElement("div",{style:{minHeight:"100vh",minHeight:"100dvh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:20,background:bg1}},
    React.createElement(Glow),
    React.createElement(Confetti,{active:conf}),
    React.createElement("div",{style:{zIndex:2,textAlign:"center",maxWidth:400}},
      React.createElement("div",{style:{fontSize:"clamp(64px,18vw,90px)",marginBottom:10,animation:"bounceIn .5s ease-out"}},em),
      React.createElement("h2",{style:{fontSize:"clamp(28px,8vw,36px)",fontWeight:700,marginBottom:6,animation:"slideUp .5s ease-out"}},msg),
      React.createElement("div",{style:{fontSize:18,color:"rgba(255,255,255,.55)",marginBottom:22,animation:"slideUp .6s ease-out"}},ok," out of ",results.length," correct"),
      // Stars
      React.createElement("div",{style:{background:"linear-gradient(145deg,rgba(255,215,0,.12),rgba(255,215,0,.04))",border:"1.5px solid rgba(255,215,0,.25)",borderRadius:20,padding:"14px 28px",display:"inline-flex",alignItems:"center",gap:10,marginBottom:22,animation:"bounceIn .7s ease-out"}},
        React.createElement("span",{style:{fontSize:34}},"â­"),
        React.createElement("span",{style:{fontSize:26,fontWeight:700,color:"#FFD700"}},"+",earned),
        React.createElement("span",{style:{fontSize:14,color:"rgba(255,215,0,.5)"}},"stars!")
      ),
      // Prize
      prize&&React.createElement("div",{style:{background:"linear-gradient(145deg,rgba(255,59,139,.18),rgba(180,75,255,.08))",border:"2px solid #FF3B8B",borderRadius:22,padding:"20px 24px",marginBottom:22,animation:"bounceIn .8s ease-out"}},
        React.createElement("div",{style:{fontSize:13,color:"#FF3B8B",fontWeight:600,marginBottom:8,letterSpacing:1}},"ðŸŽ‰ NEW PRIZE UNLOCKED! ðŸŽ‰"),
        React.createElement("div",{style:{fontSize:44,marginBottom:6}},prize.emoji),
        React.createElement("div",{style:{fontSize:19,fontWeight:700}},prize.name)
      ),
      React.createElement("div",{style:{fontSize:16,color:"rgba(255,255,255,.4)",marginBottom:30,animation:"slideUp .9s ease-out"}},pick(CHEERS)),
      React.createElement("div",{style:{display:"flex",gap:14,justifyContent:"center",flexWrap:"wrap"}},
        React.createElement(Tap,{onClick:onAgain,sayText:"Play again!",style:{background:"linear-gradient(135deg,#FF3B8B,#FF6B8B)",borderRadius:20,padding:"16px 30px",fontSize:"clamp(17px,4vw,20px)",fontWeight:600,boxShadow:"0 6px 20px rgba(255,59,139,.3)"}},"ðŸ”„ Again!"),
        React.createElement(Tap,{onClick:onHome,sayText:"Going home!",style:{background:"linear-gradient(135deg,#2A1F3D,#3A2F5D)",border:"1.5px solid rgba(255,255,255,.12)",borderRadius:20,padding:"16px 30px",fontSize:"clamp(17px,4vw,20px)",fontWeight:600}},"ðŸ  Home")
      )
    )
  );
};

// â•â•â• PRIZES SCREEN â•â•â•
const PrizesPage=({progress,onBack})=>{
  useEffect(()=>{
    const t=setTimeout(()=>{
      const unlocked=PRIZES.filter(p=>p.stars<=progress.stars);
      const locked=PRIZES.filter(p=>p.stars>progress.stars);
      if(unlocked.length)say("You have "+unlocked.length+" prizes! "+unlocked.map(p=>p.name).join(", ")+(locked.length?". Keep playing to unlock more!":""),0.95);
      else say("Play games to earn stars and unlock prizes! First prize is "+PRIZES[0].name+" at "+PRIZES[0].stars+" stars!",0.95);
    },400);
    return()=>clearTimeout(t);
  },[]);

  return React.createElement("div",{style:{minHeight:"100vh",minHeight:"100dvh",display:"flex",flexDirection:"column",alignItems:"center",padding:"20px 16px 40px",background:bg1}},
    React.createElement(Glow),
    React.createElement("div",{style:{zIndex:2,width:"100%",maxWidth:440}},
      React.createElement("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:26}},
        React.createElement(Tap,{onClick:()=>{say("Going back!");onBack()},style:{background:"rgba(255,255,255,.07)",borderRadius:12,padding:"8px 16px",fontSize:15,color:"rgba(255,255,255,.5)"}},"â† Back"),
        React.createElement("h2",{style:{fontSize:24,fontWeight:700}},"ðŸŽ Sari's Prizes")
      ),
      React.createElement("div",{style:{display:"flex",flexDirection:"column",gap:14}},
        ...PRIZES.map((p,i)=>{
          const ok=progress.stars>=p.stars;
          return React.createElement(Tap,{key:p.id,
            sayText:ok?(p.name+" Unlocked!"):(p.name+". You need "+p.stars+" stars. You have "+progress.stars),
            style:{
              background:ok?"linear-gradient(145deg,rgba(255,215,0,.1),rgba(255,59,139,.06))":"rgba(255,255,255,.025)",
              border:ok?"1.5px solid rgba(255,215,0,.25)":"1px solid rgba(255,255,255,.06)",
              borderRadius:20,padding:"16px 20px",display:"flex",alignItems:"center",gap:14,
              opacity:ok?1:.4,animation:`slideUp .4s ease-out ${i*.07}s both`,width:"100%",textAlign:"left"
            }},
            React.createElement("div",{style:{fontSize:"clamp(34px,9vw,46px)"}},ok?p.emoji:"ðŸ”’"),
            React.createElement("div",{style:{flex:1}},
              React.createElement("div",{style:{fontSize:16,fontWeight:600}},p.name),
              React.createElement("div",{style:{fontSize:12,color:"rgba(255,255,255,.4)"}},ok?"âœ… Unlocked!":p.stars+" stars needed")
            ),
            ok&&React.createElement("div",{style:{fontSize:22}},"âœ¨")
          );
        })
      ),
      React.createElement("div",{style:{textAlign:"center",marginTop:28,color:"rgba(255,255,255,.25)",fontSize:13}},"Show Abba your coupons to redeem! ðŸŽŸï¸")
    )
  );
};

// â•â•â• MAIN APP â•â•â•
const App=()=>{
  const[scr,setScr]=useState("splash");
  const[mode,setMode]=useState(null);
  const[rr,setRR]=useState([]);
  const[earned,setEarned]=useState(0);
  const[prize,setPrize]=useState(null);
  const[prog,setProg]=useState(load());

  const startGame=(m)=>{setMode(m);setRR([]);setEarned(0);setPrize(null);setScr("game")};

  const finishRound=(results)=>{
    const ok=results.filter(Boolean).length;
    const e=ok*3;
    const nt=prog.stars+e;
    const np=PRIZES.find(p=>p.stars<=nt&&p.stars>prog.stars);
    const streak=ok===ROUND?(prog.bestStreak||0)+1:0;
    const newP={stars:nt,totalCorrect:prog.totalCorrect+ok,totalPlayed:prog.totalPlayed+ROUND,bestStreak:Math.max(prog.bestStreak||0,streak)};
    setProg(newP);save(newP);
    setRR(results);setEarned(e);setPrize(np||null);setScr("results");

    // Announce prize!
    if(np)setTimeout(()=>say("Amazing! You unlocked a new prize! "+np.name,1.1),500);
  };

  if(scr==="splash")return React.createElement(Splash,{onStart:()=>setScr("home")});
  if(scr==="home")return React.createElement(Home,{progress:prog,onMode:startGame,onPrizes:()=>setScr("prizes")});
  if(scr==="game")return React.createElement(Game,{mode,onFinish:finishRound,onBack:()=>setScr("home")});
  if(scr==="results")return React.createElement(Results,{results:rr,earned,onHome:()=>setScr("home"),onAgain:()=>startGame(mode),prize});
  if(scr==="prizes")return React.createElement(PrizesPage,{progress:prog,onBack:()=>setScr("home")});
  return null;
};

ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
</script>
</body>
</html>
